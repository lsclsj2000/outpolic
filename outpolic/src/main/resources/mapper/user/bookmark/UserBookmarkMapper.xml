<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="outpolic.user.bookmark.mapper.UserBookmarkMapper">
	<resultMap id="UserBookmarkViewResultMap" type="outpolic.user.bookmark.dto.UserBookmarkViewDTO">
		<!-- 북마크 정보 -->
	    <id property="bmCd" column="bm_cd" />
	    <result property="mbrCd" column="mbr_cd" />
	    <result property="clCd" column="cl_cd" />
	    <result property="clType" column="cl_type" />
	    <result property="bmRegYmdt" column="bm_reg_ymdt" />
	
	    <result property="cntdCd" column="cntd_cd" />
	    
	    <!-- 공통 콘텐츠 정보 -->
	    <result property="title" column="title" />
	    <result property="writer" column="writer" />
	    <result property="ctgryNm" column="ctgry_nm" />
	    <result property="thumbnailUrl" column="thumbnail_url" />
	
	    <!-- 외주일 경우 -->
	    <result property="osCd" column="os_cd" />
	    <result property="osAmt" column="os_amt" />
	
	    <!-- 포트폴리오일 경우 -->
	    <result property="prtfCd" column="prtf_cd" />
	    <result property="prtfDwnldCnt" column="prtf_dwnld_cnt" />
	
	    <!-- 기업일 경우 -->
	    <result property="entCd" column="ent_cd" />
	    <result property="entRprsv" column="ent_rprsv" />
	    <result property="entScr" column="ent_scr" />
	</resultMap>    
<!-- 기업정보. 필요한 컬럼 :  -->
	<select id="getBookmartEiByCode">
		select b.bm_cd, b.mbr_cd, b.cl_cd, b.bm_reg_ymdt, cl.cntd_cd, e.ent_cd, e.ent_nm as title, e.ent_rprsv as supervisor
		from bookmark b inner JOIN content_list cl on b.cl_cd =cl.cl_cd
		inner join enterprise e on cl.cntd_cd = e.ent_cd
		inner join category_mapping cm on cm.cl_cd=cl.cl_cd
		inner join category c on c.ctgry_id= cm.ctgry_id
		where b.mbr_cd = 'MB_C0000119' and cl.cntd_cd like 'EI%'
		group by b.bm_cd
		order by bm_reg_ymdt DESC;
		
	</select>

	<select id="getBookmartOsByCode">
		select b.bm_cd, b.mbr_cd, b.cl_cd, b.bm_reg_ymdt, c.ctgry_nm, cl.cntd_cd, o.os_cd, e.ent_cd, e.ent_nm as title
		from bookmark b inner JOIN content_list cl on b.cl_cd =cl.cl_cd
		inner join outsourcing o on cl.cntd_cd = o.os_cd
		inner join enterprise e on e.ent_cd =o.ent_cd 
		inner join category c on c.ctgry_id = o.ctgry_id
		where b.mbr_cd = 'MB_C0000119' and cl.cntd_cd like 'OS%'
		order by bm_reg_ymdt DESC;
	</select>
	<select id="getBookmartPoByCode">
		select b.bm_cd, b.mbr_cd, b.cl_cd, b.bm_reg_ymdt, c.ctgry_nm, cl.cntd_cd, p.prtf_cd, e.ent_cd, e.ent_nm as title
		from bookmark b inner JOIN content_list cl on b.cl_cd =cl.cl_cd
		inner join portfolio p on cl.cntd_cd = p.prtf_cd
		inner join enterprise e on e.ent_cd = p.ent_cd
		inner join category_mapping cm on cm.cl_cd=cl.cl_cd
		inner join category c on c.ctgry_id= cm.ctgry_id
		where b.mbr_cd = 'MB_C0000119'and cl.cntd_cd like 'PO%'
		group by b.bm_cd
		order by bm_reg_ymdt DESC
	</select>


</mapper>







