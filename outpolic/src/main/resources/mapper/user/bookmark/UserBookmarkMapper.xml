<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="outpolic.user.bookmark.mapper.UserBookmarkMapper">
	<resultMap id="UserBookmarkViewResultMap" type="outpolic.user.bookmark.dto.UserBookmarkViewDTO">
		<!-- 북마크 정보 -->
	    <id property="bmCd" column="bm_cd" />
	    <result property="mbrCd" column="mbr_cd" />
	    <result property="clCd" column="cl_cd" />
	    <result property="clType" column="cl_type" />
	    <result property="bmRegYmdt" column="bm_reg_ymdt" />
	
	    <result property="cntdCd" column="cntd_cd" />
	    
	    <!-- 공통 콘텐츠 정보 -->
	    <result property="ctgryNm" column="ctgry_nm" />
	
	    <!-- 외주일 경우 -->
	    <result property="osCd" column="os_cd" />
	    <result property="osAmt" column="os_amt" />
	    <result property="osTtl" column="os_ttl" />
	    <result property="osThumbnailUrl" column="os_thumbnail_url" />
	
	    <!-- 포트폴리오일 경우 -->
	    <result property="prtfCd" column="prtf_cd" />
	    <result property="prtfTtl" column="prtf_ttl" />
	    <result property="prtfDwnldCnt" column="prtf_dwnld_cnt" />
	    <result property="prtfThumbnailUrl" column="prtf_thumbnail_url" />
	
	    <!-- 기업일 경우 -->
	    <result property="entCd" column="ent_cd" />
	    <result property="entNm" column="ent_nm" />
	    <result property="entRprsv" column="ent_rprsv" />
	    <result property="entScr" column="ent_scr" />
	    <result property="entImg" column="ent_img" />
	</resultMap>    
<!-- 기업정보. 필요한 컬럼 : 북마크코드, 회원코드(회원식별용도), 대표자명, 기업명, 프로필 이미지, 카테고리이름, 기업프사 -->
	<select id="getBookmarkEiByCode" parameterType="String">
		select b.bm_cd, b.mbr_cd, b.bm_reg_ymdt, b.cl_cd, cl.cntd_cd, e.ent_cd, e.ent_nm, e.ent_rprsv, e.ent_img
		from bookmark b inner JOIN content_list cl on b.cl_cd =cl.cl_cd
		inner join enterprise e on cl.cntd_cd = e.ent_cd
		inner join category_mapping cm on cm.cl_cd=cl.cl_cd
		inner join category c on c.ctgry_id= cm.ctgry_id
		where b.mbr_cd = #{memberCode} and cl.cntd_cd like 'EI%'
		group by b.bm_cd
		order by b.bm_reg_ymdt DESC;
		
	</select>
<!-- 외주. 필요한 컬럼 : 북마크코드, 회원코드(회원식별용도), 외주제목, 금액, 기업명, 외주썸네일-->
	<select id="getBookmarkOsByCode" parameterType="String">
		select b.bm_cd, b.mbr_cd, b.cl_cd, b.bm_reg_ymdt, cl.cntd_cd, o.os_cd, o.os_ttl, o.os_amt, e.ent_cd, e.ent_nm, o.os_thumbnail_url 
		from bookmark b inner JOIN content_list cl on b.cl_cd =cl.cl_cd
		inner join outsourcing o on cl.cntd_cd = o.os_cd
		inner join enterprise e on e.ent_cd =o.ent_cd 
		where b.mbr_cd = #{memberCode} and cl.cntd_cd like 'OS%'
		order by b.bm_reg_ymdt DESC;
	</select>
	
	<!-- 포폴 필요한컬럼 : 북마크코드, 회원코드(식별용도), 포폴제목, 포폴작성기업, 카테고리이름 -->
	<select id="getBookmarkPoByCode" parameterType="String">
		select b.bm_cd, b.mbr_cd, b.cl_cd, b.bm_reg_ymdt, c.ctgry_nm, cl.cntd_cd, p.prtf_cd, p.prtf_ttl, e.ent_cd, e.ent_nm, p.prtf_thumbnail_url 
		from bookmark b inner JOIN content_list cl on b.cl_cd =cl.cl_cd
		inner join portfolio p on cl.cntd_cd = p.prtf_cd
		inner join enterprise e on e.ent_cd = p.ent_cd
		inner join category_mapping cm on cm.cl_cd=cl.cl_cd
		inner join category c on c.ctgry_id= cm.ctgry_id
		where b.mbr_cd = #{memberCode} and cl.cntd_cd like 'PO%'
		group by b.bm_cd
		order by bm_reg_ymdt DESC
	</select>


</mapper>







